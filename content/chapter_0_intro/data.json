{
    "title": "Пролог: Тени Морхейма",
    "startScene": "intro_road",
    "scenes": {
        "intro_road": {
            "text": [
                "Холодный ветер пробирает до костей. Температура падает с каждой минутой. Если ты не найдешь укрытие в ближайший час, холод убьет тебя быстрее, чем голод.",
                "Впереди, сквозь метель, виднеются огни заставы города Морхейм."
            ],
            "choices": [
                { 
                    "text": "Подойти к воротам", 
                    "next": "gate_dialogue" 
                },
                { 
                    "text": "Осмотреть стены в поисках лазейки (Скрытность)", 
                    "next": "wall_inspect" 
                }
            ]
        },

        "wall_inspect": {
            "text": [
                "Ты находишь старую брешь в частоколе. Она узкая, но пролезть можно.",
                "С другой стороны слышен лай собак."
            ],
            "choices": [
                {
                    "text": "Рискнуть и пролезть",
                    "next": "sneaking_success",
                    "effect": { "skillUp": "Скрытность" }
                },
                {
                    "text": "Слишком опасно. Идем к воротам",
                    "next": "gate_dialogue"
                }
            ]
        },

        "sneaking_success": {
            "text": "Ты проскальзываешь внутрь, порвав рукав плаща. Собаки лают, но стража слишком ленива, чтобы проверять. Ты в городе.",
            "choices": [
                { "text": "Выйти на площадь", "next": "town_square" }
            ]
        },

        "gate_dialogue": {
            "text": [
                "Стражник у ворот греет руки над жаровней. От него разит дешевым элем.",
                "— Стой! Вход в город закрыт до утра. Либо плати <b>5 золотых</b> налога, либо проваливай мерзнуть в лес."
            ],
            "choices": [
                {
                    "text": "Заплатить 5 монет",
                    "next": "town_square",
                    "req": { "gold": 5 },
                    "effect": { "gold": -5 }
                },
                {
                    "text": "Попытаться запугать (Сила)",
                    "next": "guard_intimidation"
                },
                {
                    "text": "Атаковать его",
                    "next": "guard_combat"
                }
            ]
        },

        "guard_intimidation": {
            "text": "Ты кладешь руку на оружие и смотришь ему в глаза. Стражник колеблется.",
            "choices": [
                {
                    "text": "Надавить авторитетом",
                    "next": "town_square",
                    "effect": { "skillUp": "Сила" }
                }
            ]
        },

        "guard_combat": {
            "text": "Твой кинжал находит цель быстрее, чем он успевает поднять тревогу. Стражник падает лицом в снег.",
            "choices": [
                {
                    "text": "Обыскать тело",
                    "next": "guard_loot"
                }
            ]
        },

        "guard_loot": {
            "text": [
                "В карманах пусто, лишь старый медальон. На нем гравировка: <i>'Любимому сыну от отца-кузнеца'</i>.",
                "Ты прячешь тело в сугроб и входишь в город."
            ],
            "choices": [
                {
                    "text": "Идти на площадь",
                    "next": "town_square",
                    "effect": { 
                        "setFlag": "guard_killed", 
                        "addItem": "Медальон стражника",
                        "addLore": "Ты убил стражника у ворот. Об этом пока никто не знает."
                    }
                }
            ]
        },

        "town_square": {
            "text": [
                "Центральная площадь Морхейма. Посредине стоит огромная статуя погасшего Солнца.",
                "Слева слышен шум из <b>Таверны 'Последний Уголек'</b>.",
                "Справа виднеется вывеска <b>Кузницы</b>, из трубы валит дым.",
                "Впереди уходит темный, неосвещенный переулок."
            ],
            "choices": [
                { "text": "Пойти в Таверну", "next": "tavern_main" },
                { "text": "Пойти в Кузницу", "next": "blacksmith_logic_check" },
                { "text": "Свернуть в темный переулок", "next": "dark_alley" }
            ]
        },

        "tavern_main": {
            "text": [
                "В таверне тепло и пахнет жареным мясом. Здесь собрались наемники, торговцы и воры.",
                "Трактирщик протирает стакан за стойкой."
            ],
            "choices": [
                { "text": "Слушать сплетни (Ловкость ушей)", "next": "tavern_rumors" },
                { "text": "Сыграть в кости (Ставка 5 монет)", "next": "dice_game", "req": { "gold": 5 } },
                { "text": "Снять комнату на ночь (10 монет)", "next": "rent_room_win", "req": { "gold": 10 } },
                { "text": "Вернуться на площадь", "next": "town_square" }
            ]
        },

        "tavern_rumors": {
            "text": "Ты прислушиваешься к разговору двух торговцев. 'Говорят, в шахтах на севере проснулось что-то древнее. Рабочие отказываются спускаться без охраны.'",
            "choices": [
                { 
                    "text": "Запомнить информацию", 
                    "next": "tavern_main",
                    "effect": { "addLore": "Слух: В северных шахтах небезопасно." }
                }
            ]
        },

        "dice_game": {
            "text": "Ты садишься за стол к одноглазому игроку. Он бросает кости. Выпадает 7. Твоя очередь.",
            "choices": [
                { "text": "Бросить кости (Честно)", "next": "dice_result_random" },
                { "text": "Сжульничать (Ловкость)", "next": "dice_cheat", "req": { "skillName": "Ловкость", "val": 1 } }
            ]
        },

        "dice_result_random": {
            "text": "Твои кости показывают... 4. Ты проиграл.",
            "choices": [
                { 
                    "text": "Черт побери!", 
                    "next": "tavern_main", 
                    "effect": { "gold": -5 } 
                }
            ]
        },

        "dice_cheat": {
            "text": "Ловким движением пальцев ты подменяешь кость. Выпадает 12! Одноглазый ворчит, но отдает деньги.",
            "choices": [
                { 
                    "text": "Забрать выигрыш", 
                    "next": "tavern_main", 
                    "effect": { "gold": 5, "skillUp": "Ловкость" } 
                }
            ]
        },

        "blacksmith_logic_check": {
            "type": "logic",
            "next": {
                "guard_killed": "blacksmith_tragic",
                "default": "blacksmith_normal"
            }
        },

        "blacksmith_normal": {
            "text": [
                "В кузнице жарко. Могучий старик бьет молотом по раскаленной стали.",
                "— Добро пожаловать! Если ищешь оружие, то лучше моих клинков не найдешь."
            ],
            "choices": [
                { "text": "Поговорить о работе", "next": "blacksmith_job" },
                { "text": "Уйти", "next": "town_square" }
            ]
        },

        "blacksmith_job": {
            "text": "— Руки у тебя крепкие. Если принесешь мне редкой руды из шахт, я заплачу втройне.",
            "choices": [
                { 
                    "text": "Я запомню (Получен Квест)", 
                    "next": "town_square",
                    "effect": { "addLore": "Квест: Кузнец ищет руду." }
                }
            ]
        },

        "blacksmith_tragic": {
            "text": [
                "Дверь кузницы открыта, но горн погас. Внутри холодно.",
                "Посреди мастерской сидит женщина и рыдает, сжимая в руках какую-то рубаху.",
                "— Уходите... Кузнец мертв. Он повесился час назад, когда узнал, что нашего сына зарезали у ворот..."
            ],
            "choices": [
                { "text": "Молча уйти (Совесть мучает)", "next": "town_square" },
                { "text": "Отдать медальон", "next": "blacksmith_medallion", "req": { "noFlag": "medallion_given" } }
            ]
        },

        "blacksmith_medallion": {
            "text": [
                "Ты протягиваешь медальон. Женщина вскрикивает и выхватывает его.",
                "— Это... это его! Откуда он у тебя?!",
                "Она смотрит на тебя с подозрением и ужасом."
            ],
            "choices": [
                { "text": "Сказать, что нашел тело", "next": "town_square", "effect": { "setFlag": "medallion_given", "skillUp": "Красноречие" } },
                { "text": "Уйти без слов", "next": "town_square" }
            ]
        },

        "dark_alley": {
            "text": "Темный переулок завален мусором. Внезапно из тени выходят двое с ножами.",
            "choices": [
                { "text": "Драться (Сила)", "next": "alley_fight" },
                { "text": "Убежать на площадь", "next": "town_square", "effect": { "hp": -10 } }
            ]
        },
        
        "alley_fight": {
            "text": "Бой короткий и жестокий. Ты разбиваешь нос первому, второй убегает в страхе. Ты находишь кошелек на земле.",
            "choices": [
                { 
                    "text": "Забрать трофей", 
                    "next": "town_square",
                    "effect": { "gold": 15, "skillUp": "Сила", "hp": -5 }
                }
            ]
        },

        "rent_room_win": {
            "text": [
                "Ты платишь хозяину таверны. Он дает тебе ключ от комнаты на чердаке.",
                "Там холодно, но есть кровать и одеяло. Ты пережил эту ночь.",
                "<br><b>КОНЕЦ ПРОЛОГА</b>"
            ],
            "choices": [
                { "text": "Лечь спать (Сохранить)", "next": "end_demo" }
            ]
        },
        
        "end_demo": {
            "text": "Поздравляю! Ты прошел пролог. Дальше будет Глава 1: Шепот Шахт.",
            "choices": []
        }
    }
}
